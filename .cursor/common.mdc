---
description: 项目通用开发规范和最佳实践，包括类型定义规范、代码风格、模块设计等常用规则
globs: 
alwaysApply: true
---
# 通用开发规范

## 类型定义规范

### 类型文件位置
- **所有类型定义必须放在 `src/types/` 目录下**
- 每个功能模块的类型应该独立成文件，文件名格式：`{module-name}.ts`
- 示例：
  - `src/types/chat.ts` - 聊天相关类型
  - `src/types/ai-provider.ts` - AI Provider 相关类型
  - `src/types/user.ts` - 用户相关类型

### 类型导出规范
- 使用 `export interface` 或 `export type` 导出类型
- 优先使用 `interface` 定义对象类型
- 使用 `type` 定义联合类型、交叉类型或类型别名
- 禁止在业务代码文件中定义类型，必须统一放在 `src/types/` 目录

### 类型导入规范
- 从 `@/types/{module-name}` 导入类型
- 示例：`import type { AiProvider } from '@/types/ai-provider'`
- 禁止在 `preload/index.d.ts` 等文件中直接定义业务类型，应该从 `src/types/` 导入并重新导出（如需要保持向后兼容）

## 代码风格规范

### 基本原则
- **不要过度设计，保证代码简洁易懂，简单实用**
- **注意圈复杂度，代码尽可能复用**
- **注意模块设计，尽量使用设计模式**
- **改动时最小化修改，尽量不修改到其他模块代码**

### 文件命名
- 使用 kebab-case：`xxx-handler.ts`、`ai-provider.ts`
- 禁止使用 camelCase 或 snake_case

### 代码复用
- 提取公共逻辑到工具函数
- 使用设计模式提高代码复用性
- 避免重复代码，优先考虑抽象和封装

### 模块设计
- 保持模块职责单一
- 模块间低耦合、高内聚
- 优先使用组合而非继承
- 合理使用设计模式（工厂模式、策略模式、观察者模式等）

## 依赖管理规范

### 包管理器
- **统一使用 pnpm，禁止使用 npm 和 yarn**
- 所有依赖安装、更新、删除操作必须使用 pnpm

## 代码修改原则

### 最小化修改
- 修改代码时，尽量只修改必要的部分
- 避免修改不相关的模块代码
- 保持现有代码结构和风格
- 优先通过扩展而非修改现有代码来实现新功能

## 类型安全

### TypeScript 使用规范
- 充分利用 TypeScript 的类型系统
- 避免使用 `any`，优先使用具体类型或 `unknown`
- 使用类型推断，减少冗余类型注解
- 使用类型守卫确保运行时类型安全

## 代码组织

### 目录结构
- 按功能模块组织代码
- 相关文件放在同一目录下
- 公共代码放在 `common/` 目录
- 类型定义统一放在 `types/` 目录

### 导入顺序
1. 第三方库导入
2. 项目内部模块导入
3. 类型导入（使用 `import type`）
4. 相对路径导入

## 禁止事项

- ❌ 禁止在业务代码文件中定义类型（必须放在 `src/types/`）
- ❌ 禁止使用 npm 和 yarn（必须使用 pnpm）
- ❌ 禁止过度设计，保持代码简洁实用
- ❌ 禁止修改不相关的模块代码
- ❌ 禁止使用 `any` 类型（优先使用具体类型）
- ❌ 禁止硬编码字符串（使用常量）
- ❌ 禁止重复代码（提取公共逻辑）
